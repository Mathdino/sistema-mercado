{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/outros/market-delivery-app/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\nimport { PrismaPg } from \"@prisma/adapter-pg\";\nimport { Pool } from \"pg\";\n\nconst prismaClientSingleton = () => {\n  const connectionString = process.env.DATABASE_URL || \"\";\n  const pool = new Pool({ connectionString });\n  const adapter = new PrismaPg(pool);\n  return new PrismaClient({ adapter });\n};\n\ndeclare global {\n  var prisma: undefined | ReturnType<typeof prismaClientSingleton>;\n}\n\nconst prisma = globalThis.prisma ?? prismaClientSingleton();\n\nexport default prisma;\n\nif (process.env.NODE_ENV !== \"production\") globalThis.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,wBAAwB;IAC5B,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY,IAAI;IACrD,MAAM,OAAO,IAAI,4GAAI,CAAC;QAAE;IAAiB;IACzC,MAAM,UAAU,IAAI,+OAAQ,CAAC;IAC7B,OAAO,IAAI,6IAAY,CAAC;QAAE;IAAQ;AACpC;AAMA,MAAM,SAAS,WAAW,MAAM,IAAI;uCAErB;AAEf,wCAA2C,WAAW,MAAM,GAAG"}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/outros/market-delivery-app/app/api/orders/%5Bid%5D/status/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport prisma from \"@/lib/prisma\"\r\nimport { OrderStatus } from \"@prisma/client\"\r\n\r\nexport async function PUT(req: NextRequest, { params }: { params: { id: string } }) {\r\n  try {\r\n    console.log(\"Received request to update order status\")\r\n    console.log(\"Order ID:\", params.id)\r\n    \r\n    // Get the new status from request body\r\n    const body = await req.json()\r\n    const { status } = body\r\n    \r\n    console.log(\"New status:\", status)\r\n    \r\n    // Validate status - explicitly check each value\r\n    const validStatuses = [\r\n      \"PENDING\",\r\n      \"CONFIRMED\",\r\n      \"PREPARING\",\r\n      \"DELIVERING\",\r\n      \"DELIVERED\",\r\n      \"CANCELLED\"\r\n    ]\r\n    \r\n    if (!status || !validStatuses.includes(status)) {\r\n      console.log(\"Invalid status:\", status)\r\n      return NextResponse.json({ error: \"invalid_status\" }, { status: 400 })\r\n    }\r\n    \r\n    // Update the order status\r\n    const updatedOrder = await prisma.order.update({\r\n      where: { id: params.id },\r\n      data: { status: status as OrderStatus },\r\n      include: {\r\n        user: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n            phone: true,\r\n            email: true,\r\n            cpf: true,\r\n          }\r\n        },\r\n        items: true,\r\n        deliveryAddress: true,\r\n      },\r\n    })\r\n    \r\n    console.log(\"Order updated successfully\")\r\n    // Return the updated order with all related data\r\n    return NextResponse.json(updatedOrder)\r\n  } catch (error: any) {\r\n    console.error(\"Error updating order status:\", error)\r\n    \r\n    if (error.code === \"P2025\") {\r\n      return NextResponse.json({ error: \"order_not_found\" }, { status: 404 })\r\n    }\r\n    \r\n    return NextResponse.json({ error: \"internal_server_error\" }, { status: 500 })\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;AAGO,eAAe,IAAI,GAAgB,EAAE,EAAE,MAAM,EAA8B;IAChF,IAAI;QACF,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,aAAa,OAAO,EAAE;QAElC,uCAAuC;QACvC,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,MAAM,EAAE,GAAG;QAEnB,QAAQ,GAAG,CAAC,eAAe;QAE3B,gDAAgD;QAChD,MAAM,gBAAgB;YACpB;YACA;YACA;YACA;YACA;YACA;SACD;QAED,IAAI,CAAC,UAAU,CAAC,cAAc,QAAQ,CAAC,SAAS;YAC9C,QAAQ,GAAG,CAAC,mBAAmB;YAC/B,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,0BAA0B;QAC1B,MAAM,eAAe,MAAM,0HAAM,CAAC,KAAK,CAAC,MAAM,CAAC;YAC7C,OAAO;gBAAE,IAAI,OAAO,EAAE;YAAC;YACvB,MAAM;gBAAE,QAAQ;YAAsB;YACtC,SAAS;gBACP,MAAM;oBACJ,QAAQ;wBACN,IAAI;wBACJ,MAAM;wBACN,OAAO;wBACP,OAAO;wBACP,KAAK;oBACP;gBACF;gBACA,OAAO;gBACP,iBAAiB;YACnB;QACF;QAEA,QAAQ,GAAG,CAAC;QACZ,iDAAiD;QACjD,OAAO,+QAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,gCAAgC;QAE9C,IAAI,MAAM,IAAI,KAAK,SAAS;YAC1B,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}