module.exports=[55694,a=>{"use strict";var b=a.i(51220),c=a.i(2295),d=a.i(41602),e=a.i(93995),f=a.i(26128),g=a.i(45305),h=a.i(40695),i=a.i(3130),j=a.i(7379),k=a.i(17171),l=a.i(38032),m=a.i(92432),n=a.i(2209),o=a.i(87695),p=a.i(33734),q=a.i(91586),r=a.i(31146),s=a.i(20755),t=a.i(53679),u="rovingFocusGroup.onEntryFocus",v={bubbles:!1,cancelable:!0},w="RovingFocusGroup",[x,y,z]=(0,p.createCollection)(w),[A,B]=(0,n.createContextScope)(w,[z]),[C,D]=A(w),E=c.forwardRef((a,c)=>(0,b.jsx)(x.Provider,{scope:a.__scopeRovingFocusGroup,children:(0,b.jsx)(x.Slot,{scope:a.__scopeRovingFocusGroup,children:(0,b.jsx)(F,{...a,ref:c})})}));E.displayName=w;var F=c.forwardRef((a,d)=>{let{__scopeRovingFocusGroup:e,orientation:f,loop:g=!1,dir:h,currentTabStopId:i,defaultCurrentTabStopId:j,onCurrentTabStopIdChange:k,onEntryFocus:n,preventScrollOnEntryFocus:p=!1,...q}=a,w=c.useRef(null),x=(0,m.useComposedRefs)(d,w),z=(0,t.useDirection)(h),[A=null,B]=(0,s.useControllableState)({prop:i,defaultProp:j,onChange:k}),[D,E]=c.useState(!1),F=(0,r.useCallbackRef)(n),G=y(e),H=c.useRef(!1),[I,K]=c.useState(0);return c.useEffect(()=>{let a=w.current;if(a)return a.addEventListener(u,F),()=>a.removeEventListener(u,F)},[F]),(0,b.jsx)(C,{scope:e,orientation:f,dir:z,loop:g,currentTabStopId:A,onItemFocus:c.useCallback(a=>B(a),[B]),onItemShiftTab:c.useCallback(()=>E(!0),[]),onFocusableItemAdd:c.useCallback(()=>K(a=>a+1),[]),onFocusableItemRemove:c.useCallback(()=>K(a=>a-1),[]),children:(0,b.jsx)(o.Primitive.div,{tabIndex:D||0===I?-1:0,"data-orientation":f,...q,ref:x,style:{outline:"none",...a.style},onMouseDown:(0,l.composeEventHandlers)(a.onMouseDown,()=>{H.current=!0}),onFocus:(0,l.composeEventHandlers)(a.onFocus,a=>{let b=!H.current;if(a.target===a.currentTarget&&b&&!D){let b=new CustomEvent(u,v);if(a.currentTarget.dispatchEvent(b),!b.defaultPrevented){let a=G().filter(a=>a.focusable);J([a.find(a=>a.active),a.find(a=>a.id===A),...a].filter(Boolean).map(a=>a.ref.current),p)}}H.current=!1}),onBlur:(0,l.composeEventHandlers)(a.onBlur,()=>E(!1))})})}),G="RovingFocusGroupItem",H=c.forwardRef((a,d)=>{let{__scopeRovingFocusGroup:e,focusable:f=!0,active:g=!1,tabStopId:h,...i}=a,j=(0,q.useId)(),k=h||j,m=D(G,e),n=m.currentTabStopId===k,p=y(e),{onFocusableItemAdd:r,onFocusableItemRemove:s}=m;return c.useEffect(()=>{if(f)return r(),()=>s()},[f,r,s]),(0,b.jsx)(x.ItemSlot,{scope:e,id:k,focusable:f,active:g,children:(0,b.jsx)(o.Primitive.span,{tabIndex:n?0:-1,"data-orientation":m.orientation,...i,ref:d,onMouseDown:(0,l.composeEventHandlers)(a.onMouseDown,a=>{f?m.onItemFocus(k):a.preventDefault()}),onFocus:(0,l.composeEventHandlers)(a.onFocus,()=>m.onItemFocus(k)),onKeyDown:(0,l.composeEventHandlers)(a.onKeyDown,a=>{if("Tab"===a.key&&a.shiftKey)return void m.onItemShiftTab();if(a.target!==a.currentTarget)return;let b=function(a,b,c){var d;let e=(d=a.key,"rtl"!==c?d:"ArrowLeft"===d?"ArrowRight":"ArrowRight"===d?"ArrowLeft":d);if(!("vertical"===b&&["ArrowLeft","ArrowRight"].includes(e))&&!("horizontal"===b&&["ArrowUp","ArrowDown"].includes(e)))return I[e]}(a,m.orientation,m.dir);if(void 0!==b){if(a.metaKey||a.ctrlKey||a.altKey||a.shiftKey)return;a.preventDefault();let e=p().filter(a=>a.focusable).map(a=>a.ref.current);if("last"===b)e.reverse();else if("prev"===b||"next"===b){var c,d;"prev"===b&&e.reverse();let f=e.indexOf(a.currentTarget);e=m.loop?(c=e,d=f+1,c.map((a,b)=>c[(d+b)%c.length])):e.slice(f+1)}setTimeout(()=>J(e))}})})})});H.displayName=G;var I={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function J(a,b=!1){let c=document.activeElement;for(let d of a)if(d===c||(d.focus({preventScroll:b}),document.activeElement!==c))return}var K=a.i(59070),L=a.i(3512),M=a.i(68234),N="Radio",[O,P]=(0,n.createContextScope)(N),[Q,R]=O(N),S=c.forwardRef((a,d)=>{let{__scopeRadio:e,name:f,checked:g=!1,required:h,disabled:i,value:j="on",onCheck:k,form:n,...p}=a,[q,r]=c.useState(null),s=(0,m.useComposedRefs)(d,a=>r(a)),t=c.useRef(!1),u=!q||n||!!q.closest("form");return(0,b.jsxs)(Q,{scope:e,checked:g,disabled:i,children:[(0,b.jsx)(o.Primitive.button,{type:"button",role:"radio","aria-checked":g,"data-state":W(g),"data-disabled":i?"":void 0,disabled:i,value:j,...p,ref:s,onClick:(0,l.composeEventHandlers)(a.onClick,a=>{g||k?.(),u&&(t.current=a.isPropagationStopped(),t.current||a.stopPropagation())})}),u&&(0,b.jsx)(V,{control:q,bubbles:!t.current,name:f,value:j,checked:g,required:h,disabled:i,form:n,style:{transform:"translateX(-100%)"}})]})});S.displayName=N;var T="RadioIndicator",U=c.forwardRef((a,c)=>{let{__scopeRadio:d,forceMount:e,...f}=a,g=R(T,d);return(0,b.jsx)(M.Presence,{present:e||g.checked,children:(0,b.jsx)(o.Primitive.span,{"data-state":W(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:c})})});U.displayName=T;var V=a=>{let{control:d,checked:e,bubbles:f=!0,...g}=a,h=c.useRef(null),i=(0,L.usePrevious)(e),j=(0,K.useSize)(d);return c.useEffect(()=>{let a=h.current,b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(i!==e&&b){let c=new Event("click",{bubbles:f});b.call(a,e),a.dispatchEvent(c)}},[i,e,f]),(0,b.jsx)("input",{type:"radio","aria-hidden":!0,defaultChecked:e,...g,tabIndex:-1,ref:h,style:{...a.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function W(a){return a?"checked":"unchecked"}var X=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Y="RadioGroup",[Z,$]=(0,n.createContextScope)(Y,[B,P]),_=B(),aa=P(),[ab,ac]=Z(Y),ad=c.forwardRef((a,c)=>{let{__scopeRadioGroup:d,name:e,defaultValue:f,value:g,required:h=!1,disabled:i=!1,orientation:j,dir:k,loop:l=!0,onValueChange:m,...n}=a,p=_(d),q=(0,t.useDirection)(k),[r,u]=(0,s.useControllableState)({prop:g,defaultProp:f,onChange:m});return(0,b.jsx)(ab,{scope:d,name:e,required:h,disabled:i,value:r,onValueChange:u,children:(0,b.jsx)(E,{asChild:!0,...p,orientation:j,dir:q,loop:l,children:(0,b.jsx)(o.Primitive.div,{role:"radiogroup","aria-required":h,"aria-orientation":j,"data-disabled":i?"":void 0,dir:q,...n,ref:c})})})});ad.displayName=Y;var ae="RadioGroupItem",af=c.forwardRef((a,d)=>{let{__scopeRadioGroup:e,disabled:f,...g}=a,h=ac(ae,e),i=h.disabled||f,j=_(e),k=aa(e),n=c.useRef(null),o=(0,m.useComposedRefs)(d,n),p=h.value===g.value,q=c.useRef(!1);return c.useEffect(()=>{let a=a=>{X.includes(a.key)&&(q.current=!0)},b=()=>q.current=!1;return document.addEventListener("keydown",a),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",a),document.removeEventListener("keyup",b)}},[]),(0,b.jsx)(H,{asChild:!0,...j,focusable:!i,active:p,children:(0,b.jsx)(S,{disabled:i,required:h.required,checked:p,...k,...g,name:h.name,ref:o,onCheck:()=>h.onValueChange(g.value),onKeyDown:(0,l.composeEventHandlers)(a=>{"Enter"===a.key&&a.preventDefault()}),onFocus:(0,l.composeEventHandlers)(g.onFocus,()=>{q.current&&n.current?.click()})})})});af.displayName=ae;var ag=c.forwardRef((a,c)=>{let{__scopeRadioGroup:d,...e}=a,f=aa(d);return(0,b.jsx)(U,{...f,...e,ref:c})});ag.displayName="RadioGroupIndicator";var ah=a.i(61237);let ai=(0,ah.default)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var aj=a.i(97895);function ak({className:a,...c}){return(0,b.jsx)(ad,{"data-slot":"radio-group",className:(0,aj.cn)("grid gap-3",a),...c})}function al({className:a,...c}){return(0,b.jsx)(af,{"data-slot":"radio-group-item",className:(0,aj.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(ag,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,b.jsx)(ai,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}function am({className:a,...c}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,aj.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...c})}var an=a.i(68515),ao=a.i(95116),ap=a.i(72844),aq=a.i(77687),ar=a.i(19113),as=a.i(33038),at=a.i(52621),au=a.i(96926);let av=(0,ah.default)("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);var aw=a.i(75407),ax=a.i(3803);function ay(){let[a,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)("pix"),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(!1),u=(0,d.useRouter)(),{toast:v}=(0,aq.useToast)(),{items:w,getTotal:x,clearCart:y}=(0,an.useCartStore)(),{user:z,isAuthenticated:A}=(0,an.useAuthStore)(),{addOrder:B}=(0,an.useOrderStore)();(0,c.useEffect)(()=>{n(!0)},[]),(0,c.useEffect)(()=>{m&&!A&&l(!0)},[m,A]);let C=w.map(a=>({...a,product:ao.mockProducts.find(b=>b.id===a.productId)})),D=x(),E=D>=ao.mockMarket.minOrderValue?ao.mockMarket.deliveryFee:0,F=D+E,G=async a=>{a.preventDefault(),t(!0);try{let a=z.addresses.find(a=>a.isDefault);if(!a)return void v({title:"Erro ao realizar pedido",description:"Você precisa ter um endereço padrão configurado.",variant:"destructive"});let b={items:C.map(a=>({productId:a.productId,productName:a.product.name,productImage:a.product.image,quantity:a.quantity,price:a.price,subtotal:a.price*a.quantity})),totalAmount:F,deliveryFee:E,subtotal:D,paymentMethod:o.toUpperCase(),deliveryAddressId:a.id,notes:q||void 0},c=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to create order")}let d=await c.json(),e={id:d.id,userId:d.userId,items:d.items,totalAmount:d.totalAmount,deliveryFee:d.deliveryFee,subtotal:d.subtotal,status:d.status.toLowerCase(),paymentMethod:d.paymentMethod.toLowerCase(),deliveryAddress:{id:d.deliveryAddress.id,street:d.deliveryAddress.street,number:d.deliveryAddress.number,complement:d.deliveryAddress.complement||void 0,neighborhood:d.deliveryAddress.neighborhood,city:d.deliveryAddress.city,state:d.deliveryAddress.state,zipCode:d.deliveryAddress.zipCode,isDefault:d.deliveryAddress.isDefault},createdAt:d.createdAt,estimatedDelivery:d.estimatedDelivery,notes:d.notes};B(e),y(),v({title:"Pedido realizado!",description:"Seu pedido foi enviado com sucesso."}),u.push("/client/orders")}catch(a){console.error("Error creating order:",a),v({title:"Erro ao realizar pedido",description:"Ocorreu um erro ao processar seu pedido. Tente novamente.",variant:"destructive"})}finally{t(!1)}};return m&&(A||a)?(0,b.jsxs)("div",{className:"min-h-screen bg-background pb-24",children:[(0,b.jsx)(e.ClientHeader,{showBack:!0}),(0,b.jsxs)("main",{className:"space-y-4 px-4 py-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Finalizar pedido"}),(0,b.jsxs)("form",{onSubmit:G,className:"space-y-4",children:[(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(ar.MapPin,{className:"h-5 w-5"}),"Endereço de entrega"]})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{className:"font-bold flex items-center gap-2",children:[(0,b.jsx)(ax.User,{className:"h-4 w-4"})," ",z?.name]}),(0,b.jsxs)("p",{className:"text-sm flex items-center gap-2",children:[(0,b.jsx)(ar.MapPin,{className:"h-4 w-4"}),z?.addresses.find(a=>a.isDefault)?.street,", ",z?.addresses.find(a=>a.isDefault)?.number,z?.addresses.find(a=>a.isDefault)?.complement&&`, ${z?.addresses.find(a=>a.isDefault)?.complement}`," -",z?.addresses.find(a=>a.isDefault)?.neighborhood,", ",z?.addresses.find(a=>a.isDefault)?.city," -",z?.addresses.find(a=>a.isDefault)?.state,", ",z?.addresses.find(a=>a.isDefault)?.zipCode]}),(0,b.jsxs)("p",{className:"text-sm flex items-center gap-2",children:[(0,b.jsx)(aw.Phone,{className:"h-4 w-4"})," ",z?.phone]})]})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(as.CreditCard,{className:"h-5 w-5"}),"Método de pagamento"]})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsxs)(ak,{value:o,onValueChange:a=>p(a),children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(al,{value:"pix",id:"pix"}),(0,b.jsxs)(k.Label,{htmlFor:"pix",className:"flex items-center gap-2",children:[(0,b.jsx)(at.Smartphone,{className:"h-4 w-4"}),"Pix"]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(al,{value:"credit",id:"credit"}),(0,b.jsxs)(k.Label,{htmlFor:"credit",className:"flex items-center gap-2",children:[(0,b.jsx)(as.CreditCard,{className:"h-4 w-4"}),"Cartão de crédito"]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(al,{value:"debit",id:"debit"}),(0,b.jsxs)(k.Label,{htmlFor:"debit",className:"flex items-center gap-2",children:[(0,b.jsx)(as.CreditCard,{className:"h-4 w-4"}),"Cartão de débito"]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(al,{value:"cash",id:"cash"}),(0,b.jsxs)(k.Label,{htmlFor:"cash",className:"flex items-center gap-2",children:[(0,b.jsx)(au.DollarSign,{className:"h-4 w-4"}),"Dinheiro"]})]})]})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(av,{className:"h-5 w-5"}),"Observações"]})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsx)(am,{placeholder:"Alguma observação sobre o pedido?",value:q,onChange:a=>r(a.target.value)})})]}),(0,b.jsx)(i.Card,{children:(0,b.jsxs)(i.CardContent,{className:"space-y-3 p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Subtotal"}),(0,b.jsx)("span",{className:"font-medium",children:(0,ap.formatCurrency)(D)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Taxa de entrega"}),(0,b.jsx)("span",{className:"font-medium",children:E>0?(0,ap.formatCurrency)(E):"Grátis"})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-semibold",children:"Total"}),(0,b.jsx)("span",{className:"text-xl font-bold text-primary",children:(0,ap.formatCurrency)(F)})]})]})}),(0,b.jsx)(h.Button,{type:"submit",className:"w-full",size:"lg",disabled:s,children:s?"Processando...":"Confirmar"})]})]}),(0,b.jsx)(f.BottomNav,{}),(0,b.jsx)(g.LoginModal,{isOpen:a,onClose:()=>l(!1),onLoginSuccess:()=>{}})]}):null}a.s(["default",()=>ay],55694)}];

//# sourceMappingURL=app_client_checkout_page_tsx_85b2f2f6._.js.map