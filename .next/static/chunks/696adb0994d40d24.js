(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92357,e=>{"use strict";let s=(0,e.i(10965).default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);e.s(["LogOut",()=>s],92357)},69035,e=>{"use strict";var s=e.i(7156),a=e.i(81061),r=e.i(95264),t="horizontal",d=["horizontal","vertical"],i=a.forwardRef((e,a)=>{var i;let{decorative:l,orientation:n=t,...o}=e,c=(i=n,d.includes(i))?n:t;return(0,s.jsx)(r.Primitive.div,{"data-orientation":c,...l?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...o,ref:a})});i.displayName="Separator";var l=e.i(47163);function n({className:e,orientation:a="horizontal",decorative:r=!0,...t}){return(0,s.jsx)(i,{"data-slot":"separator",decorative:r,orientation:a,className:(0,l.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...t})}e.s(["Separator",()=>n],69035)},79971,e=>{"use strict";let s=(0,e.i(10965).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);e.s(["Phone",()=>s],79971)},38084,e=>{"use strict";var s=e.i(7156),a=e.i(81061),r=e.i(15599),t=e.i(1337),d=e.i(73428),i=e.i(30412),l=e.i(67881),n=e.i(70065),o=e.i(69035),c=e.i(23750),h=e.i(10708),m=e.i(4421),p=e.i(20682),u=e.i(49110),x=e.i(79971),f=e.i(92357),j=e.i(10965);let g=(0,j.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),v=(0,j.default)("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);function C(){let[e,j]=(0,a.useState)(!1),[C,N]=(0,a.useState)(!1),[y,b]=(0,a.useState)(!1),[z,S]=(0,a.useState)(!1),[L,k]=(0,a.useState)({name:"",cpf:"",phone:"",address:{street:"",number:"",complement:"",neighborhood:"",city:"",state:"",zipCode:""}}),$=(0,r.useRouter)(),{toast:F}=(0,p.useToast)(),{user:w,logout:D,isAuthenticated:P,updateUser:I}=(0,m.useAuthStore)();(0,a.useEffect)(()=>{S(!0)},[]),(0,a.useEffect)(()=>{if(z&&!P)j(!0);else if(z&&w){let e=w.addresses.find(e=>e.isDefault)||w.addresses[0];k({name:w.name||"",cpf:w.cpf?E(w.cpf):"",phone:w.phone?A(w.phone):"",address:{street:e?.street||"",number:e?.number||"",complement:e?.complement||"",neighborhood:e?.neighborhood||"",city:e?.city||"",state:e?.state||"",zipCode:e?.zipCode?B(e.zipCode):""}})}},[z,P,w]);let T=async()=>{if(w){console.log("Updating user with ID:",w.id),b(!0);try{let e=await fetch("/api/users/me",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:L.name,phone:L.phone,address:L.address})}),s=await e.json();if(console.log("API response:",s),e.ok&&s.user)I(s.user),F({title:"Perfil atualizado",description:"Suas informações foram salvas com sucesso."}),N(!1);else throw Error(s.error||"Failed to update profile")}catch(e){console.error("Error updating profile:",e),F({title:"Erro ao atualizar",description:"Não foi possível salvar as alterações. Tente novamente.",variant:"destructive"})}finally{b(!1)}}},E=e=>e.replace(/\D/g,"").slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),A=e=>e.replace(/\D/g,"").slice(0,11).replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2"),B=e=>e.replace(/\D/g,"").slice(0,8).replace(/(\d{5})(\d)/,"$1-$2");return z&&(P||e)?(0,s.jsxs)("div",{className:"min-h-screen bg-background pb-24",children:[(0,s.jsx)(t.ClientHeader,{}),(0,s.jsxs)("main",{className:"space-y-4 px-4 py-6",children:[(0,s.jsx)(n.Card,{children:(0,s.jsxs)(n.CardContent,{className:"flex items-center gap-4 p-4",children:[(0,s.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-primary",children:(0,s.jsx)("span",{className:"text-lg font-bold text-primary-foreground",children:(e=>{if(!e)return"UN";let s=e.trim().split(" ");return 1===s.length?s[0].charAt(0).toUpperCase():`${s[0].charAt(0)}${s[s.length-1].charAt(0)}`.toUpperCase()})(w?.name||"")})}),(0,s.jsx)("div",{children:(0,s.jsx)("h2",{className:"font-semibold",children:w?.name})}),(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"ml-auto",onClick:()=>N(!C),children:["Editar Conta",(0,s.jsx)(g,{className:"h-4 w-4"})]})]})}),C?(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Editar informações"})}),(0,s.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"name",children:"Nome completo"}),(0,s.jsx)(c.Input,{id:"name",value:L.name,onChange:e=>k({...L,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"cpf",children:"CPF"}),(0,s.jsx)(c.Input,{id:"cpf",value:L.cpf,readOnly:!0,className:"bg-muted"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"phone",children:"Telefone"}),(0,s.jsx)(c.Input,{id:"phone",value:L.phone,onChange:e=>{let s=A(e.target.value);k({...L,phone:s})}})]}),(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{children:"Endereço padrão"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"street",children:"Rua"}),(0,s.jsx)(c.Input,{id:"street",value:L.address.street,onChange:e=>k({...L,address:{...L.address,street:e.target.value}})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"number",children:"Número"}),(0,s.jsx)(c.Input,{id:"number",value:L.address.number,onChange:e=>k({...L,address:{...L.address,number:e.target.value}})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"complement",children:"Complemento"}),(0,s.jsx)(c.Input,{id:"complement",value:L.address.complement,onChange:e=>k({...L,address:{...L.address,complement:e.target.value}})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"neighborhood",children:"Bairro"}),(0,s.jsx)(c.Input,{id:"neighborhood",value:L.address.neighborhood,onChange:e=>k({...L,address:{...L.address,neighborhood:e.target.value}})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"zipCode",children:"CEP"}),(0,s.jsx)(c.Input,{id:"zipCode",value:L.address.zipCode,onChange:e=>{let s=B(e.target.value);k({...L,address:{...L.address,zipCode:s}})}})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"city",children:"Cidade"}),(0,s.jsx)(c.Input,{id:"city",value:L.address.city,onChange:e=>k({...L,address:{...L.address,city:e.target.value}})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"state",children:"Estado"}),(0,s.jsx)(c.Input,{id:"state",value:L.address.state,onChange:e=>k({...L,address:{...L.address,state:e.target.value}})})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.Button,{variant:"outline",className:"flex-1",onClick:()=>N(!1),disabled:y,children:"Cancelar"}),(0,s.jsx)(l.Button,{className:"flex-1",onClick:T,disabled:y,children:y?"Salvando...":"Salvar"})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Informações pessoais"})}),(0,s.jsxs)(n.CardContent,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(x.Phone,{className:"h-5 w-5 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Telefone"}),(0,s.jsx)("p",{className:"font-medium",children:w?.phone})]})]}),(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(v,{className:"h-5 w-5 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"CPF"}),(0,s.jsx)("p",{className:"font-medium",children:w?.cpf?E(w.cpf):""})]})]})]})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)(n.CardTitle,{children:"Endereço padrão"})}),(0,s.jsx)(n.CardContent,{children:w?.addresses.find(e=>e.isDefault)?(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(u.MapPin,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"font-medium",children:[w.addresses.find(e=>e.isDefault)?.street,", ",w.addresses.find(e=>e.isDefault)?.number,w.addresses.find(e=>e.isDefault)?.complement&&`, ${w.addresses.find(e=>e.isDefault)?.complement}`," -",w.addresses.find(e=>e.isDefault)?.neighborhood,", ",w.addresses.find(e=>e.isDefault)?.city," -",w.addresses.find(e=>e.isDefault)?.state,", ",w.addresses.find(e=>e.isDefault)?.zipCode]})})]}):(0,s.jsx)("p",{className:"text-muted-foreground",children:"Nenhum endereço cadastrado"})})]})]}),(0,s.jsxs)(l.Button,{variant:"outline",className:"w-full",onClick:()=>{D(),F({title:"Logout realizado",description:"Até logo!"}),$.push("/client")},children:[(0,s.jsx)(f.LogOut,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),(0,s.jsx)(d.BottomNav,{}),(0,s.jsx)(i.LoginModal,{isOpen:e,onClose:()=>j(!1),onLoginSuccess:()=>{}})]}):null}e.s(["default",()=>C],38084)}]);